import{g as p,b as l,d as u,F as k,e as U,f as t,h as _,J as C,K as S,t as c,R as I,T,r as m,O as y,H as B,I as L,C as $,X as q,o as D}from"./vendor.72820acd.js";import{a as w}from"./index.40a71972.js";import{_ as h,e as N}from"./index.fa8506b3.js";import{B as F}from"./Breadcrumb.070c323b.js";import{P as V}from"./Pagination.094cab9b.js";import{C as A,F as O}from"./Form.8007c743.js";import{C as G}from"./Carousel.39d95573.js";const E={props:{products:{type:Array,default:()=>[]},loadingStatus:{type:Object,default:()=>({loadingItem:{type:String,default:""}})}},setup(s,{emit:o}){return{openModal:a=>{o("getProduct",a)}}}},H=s=>(I("data-v-0c5b5b3c"),s=s(),T(),s),J={class:"row"},K={class:"card border-0 mb-4 position-relative"},R=["src"],X={class:"card-body p-0"},z={class:"mb-0 mt-3"},Q={class:"card-text mb-0"},W={class:"text-muted"},Y=H(()=>t("p",{class:"text-muted mt-3"},null,-1));function Z(s,o,e,a,g,v){const r=p("router-link");return l(),u("div",J,[(l(!0),u(k,null,U(e.products,n=>(l(),u("div",{class:"col-md-4",key:n.id},[t("div",K,[_(r,{to:{name:"ProductDetail",params:{id:n.id}},class:"pic"},{default:C(()=>[t("img",{src:n.imageUrl,class:"card-img-top rounded-0 img-fluid",alt:"product-img"},null,8,R)]),_:2},1032,["to"]),t("div",X,[t("h5",z,[_(r,{to:{name:"ProductDetail",params:{id:n.id}}},{default:C(()=>[S(c(n.title),1)]),_:2},1032,["to"])]),t("p",Q,[S(" NT$"+c(n.price)+" ",1),t("span",W,[t("del",null,"NT$"+c(n.origin_price),1)])]),Y])])]))),128))])}var tt=h(E,[["render",Z],["__scopeId","data-v-0c5b5b3c"]]);const ot={props:{isNew:{type:Boolean,default:!1},product:{type:Object,default:()=>({imagesUrl:{type:Array,default:()=>[]},id:{type:String,default:""}})},loadingStatus:{type:Object,default:()=>({loadingItem:{type:String,default:""}})}},setup(s,{emit:o}){return{qty:m(1)}}},at=s=>(I("data-v-e16bbad4"),s=s(),T(),s),et={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},st={class:"modal-dialog modal-xl",role:"document"},dt={class:"modal-content border-0"},nt={class:"modal-header bg-dark text-white"},rt={class:"modal-title",id:"exampleModalLabel"},ct=at(()=>t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),it={class:"modal-body"},lt={class:"row"},ut={class:"col-sm-6"},_t=["src"],pt={class:"col-sm-6"},mt={class:"badge bg-primary rounded-pill"},gt={key:0,class:"h5"},vt={key:1,class:"h6"},bt={key:2,class:"h5"},ft={class:"input-group"};function yt(s,o,e,a,g,v){return l(),u("div",et,[t("div",st,[t("div",dt,[t("div",nt,[t("h5",rt,[t("span",null,c(e.product.title),1)]),ct]),t("div",it,[t("div",lt,[t("div",ut,[t("img",{class:"img-fluid",src:e.product.imageUrl,alt:"product-img"},null,8,_t)]),t("div",pt,[t("span",mt,c(e.product.category),1),t("p",null,"\u5546\u54C1\u63CF\u8FF0\uFF1A"+c(e.product.description),1),t("p",null,"\u5546\u54C1\u5167\u5BB9\uFF1A"+c(e.product.content),1),e.product.price?y("v-if",!0):(l(),u("div",gt,c(e.product.origin_price)+" \u5143",1)),e.product.price?(l(),u("del",vt,"\u539F\u50F9 "+c(e.product.origin_price)+" \u5143",1)):y("v-if",!0),e.product.price?(l(),u("div",bt,"\u73FE\u5728\u53EA\u8981 "+c(e.product.price)+" \u5143",1)):y("v-if",!0),t("div",null,[t("div",ft,[B(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=r=>a.qty=r),min:"1"},null,512),[[L,a.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=r=>s.$emit("add-to-cart",e.product.id,a.qty))},"\u52A0\u5165\u8CFC\u7269\u8ECA")])])])])])])])],512)}var ht=h(ot,[["render",yt],["__scopeId","data-v-e16bbad4"]]);const Pt={components:{Carousel:G,Breadcrumb:F,ProdModal:ht,ProdsTable:tt,Pagination:V,Carts:A,Form:O},name:"Products",setup(){var b;const s=(b=$())==null?void 0:b.appContext.config.globalProperties.$httpMsgState,o=m(!1),e=m({}),a=m([]),g=m([]),v=m({}),r=q({loadingItem:""});D(async()=>{o.value=!0,n()});const n=async(d=1)=>{try{const i=await w.products.getProducts(d),f=i.products;e.value=i.pagination;let M=f.map(j=>j.category);g.value=[...new Set(M)],a.value=f,o.value=!1}catch(i){o.value=!1,s(i,"\u932F\u8AA4\u8A0A\u606F")}};return{isLoading:o,products:a,pagination:e,categorys:g,cart:v,loadingStatus:r,getProducts:n,addToCart:async d=>{try{r.loadingItem=d;const i={product_id:d,qty:qty.value},f=await w.cart.addCart({data:i});N.emit("get-cart"),s(f,"\u52A0\u5165\u8CFC\u7269\u8ECA"),r.loadingItem=""}catch(i){s(i,"\u52A0\u5165\u8CFC\u7269\u8ECA")}},toDetail:async d=>{router.push({path:`/apps-list/members/detail/${d._id}`})}}}},xt={class:"container pt-4 mb-5"},Ct={class:"row mt-3"},St={class:"col-md-12"},It={class:"col-md-12"};function Tt(s,o,e,a,g,v){const r=p("Loading"),n=p("Carousel"),P=p("Breadcrumb"),x=p("ProdsTable"),b=p("Pagination");return l(),u("div",xt,[_(r,{active:a.isLoading,"onUpdate:active":o[0]||(o[0]=d=>a.isLoading=d),"is-full-page":!0},null,8,["active"]),_(n),t("div",Ct,[t("div",St,[_(P)]),t("div",It,[_(x,{products:a.products,"onUpdate:products":o[1]||(o[1]=d=>a.products=d),loadingStatus:a.loadingStatus,"onUpdate:loadingStatus":o[2]||(o[2]=d=>a.loadingStatus=d),onGetProduct:a.getProducts,onAddToCart:a.addToCart},null,8,["products","loadingStatus","onGetProduct","onAddToCart"]),_(b,{pages:a.pagination,"onUpdate:pages":o[3]||(o[3]=d=>a.pagination=d),onUpdatePages:a.getProducts},null,8,["pages","onUpdatePages"])])])])}var $t=h(Pt,[["render",Tt],["__scopeId","data-v-7b19cff0"]]);export{$t as default};
