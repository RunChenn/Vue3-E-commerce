var V=Object.defineProperty;var w=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var P=(o,a,i)=>a in o?V(o,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[a]=i,C=(o,a)=>{for(var i in a||(a={}))$.call(a,i)&&P(o,i,a[i]);if(w)for(var i of w(a))B.call(a,i)&&P(o,i,a[i]);return o};import{P as E}from"./Pagination.0d147726.js";import{D as I}from"./DelModal.3f3f2f81.js";import{v as u,T as N,o as d,b as n,w as e,O as r,d as p,G as g,H as k,y as D,I as U,D as S,M as L,r as v,e as y,R as q}from"./vendor.1eeb228f.js";import{_ as j}from"./index.fa9b4643.js";import{a as O}from"./index.06ff196c.js";const z={props:{order:{type:Object,default(){return{}}}},emits:["update-paid"],setup(o,{emit:a}){const i=u({}),t=u({}),m=u(!1);return N(()=>o.order,()=>{console.log(o.order),t.value=o.order}),{status:i,tempOrder:t,isPaid:m}}},A={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},F={class:"modal-dialog modal-xl",role:"document"},G={class:"modal-content border-0"},H=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},[e("span",null,"\u8A02\u55AE\u7D30\u7BC0")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={class:"modal-body"},T={class:"row"},J={class:"col-md-4"},K=e("h3",null,"\u7528\u6236\u8CC7\u6599",-1),Q={class:"table"},W={key:0},X=e("th",{style:{width:"100px"}},"\u59D3\u540D",-1),Y=e("th",null,"Email",-1),Z=e("th",null,"\u96FB\u8A71",-1),ee=e("th",null,"\u5730\u5740",-1),te={class:"col-md-8"},oe=e("h3",null,"\u8A02\u55AE\u7D30\u7BC0",-1),ae={class:"table"},se=e("th",{style:{width:"100px"}},"\u8A02\u55AE\u7DE8\u865F",-1),le=e("th",null,"\u4E0B\u55AE\u6642\u9593",-1),de=e("th",null,"\u4ED8\u6B3E\u6642\u9593",-1),ne={key:0},re={key:1},ie=e("th",null,"\u4ED8\u6B3E\u72C0\u614B",-1),ce={key:0,class:"text-success"},ue={key:1,class:"text-muted"},_e=e("th",null,"\u7E3D\u91D1\u984D",-1),pe=e("h3",null,"\u9078\u8CFC\u5546\u54C1",-1),he={class:"table"},me=e("thead",null,[e("tr")],-1),fe={class:"text-end"},be={class:"d-flex justify-content-end"},ge={class:"form-check"},ve={class:"form-check-label",for:"flexCheckDefault"},ye={key:0},Oe={key:1},ke={class:"modal-footer"},Me=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," \u53D6\u6D88 ",-1);function xe(o,a,i,t,m,b){return d(),n("div",A,[e("div",F,[e("div",G,[H,e("div",R,[e("div",T,[e("div",J,[K,e("table",Q,[t.tempOrder.user?(d(),n("tbody",W,[e("tr",null,[X,e("td",null,r(t.tempOrder.user.name),1)]),e("tr",null,[Y,e("td",null,r(t.tempOrder.user.email),1)]),e("tr",null,[Z,e("td",null,r(t.tempOrder.user.tel),1)]),e("tr",null,[ee,e("td",null,r(t.tempOrder.user.address),1)])])):p("v-if",!0)])]),e("div",te,[oe,e("table",ae,[e("tbody",null,[e("tr",null,[se,e("td",null,r(t.tempOrder.id),1)]),e("tr",null,[le,e("td",null,r(o.$filters.date(t.tempOrder.create_at)),1)]),e("tr",null,[de,e("td",null,[t.tempOrder.paid_date?(d(),n("span",ne,r(o.$filters.date(t.tempOrder.paid_date)),1)):(d(),n("span",re,"\u6642\u9593\u4E0D\u6B63\u78BA"))])]),e("tr",null,[ie,e("td",null,[t.tempOrder.is_paid?(d(),n("strong",ce,"\u5DF2\u4ED8\u6B3E")):(d(),n("span",ue,"\u5C1A\u672A\u4ED8\u6B3E"))])]),e("tr",null,[_e,e("td",null,r(o.$filters.currency(t.tempOrder.total)),1)])])]),pe,e("table",he,[me,e("tbody",null,[(d(!0),n(g,null,k(t.tempOrder.products,c=>(d(),n("tr",{key:c.id},[e("th",null,r(c.product.title),1),e("td",null,r(c.qty)+" / "+r(c.product.unit),1),e("td",fe,r(o.$filters.currency(c.final_total)),1)]))),128))])]),e("div",be,[e("div",ge,[D(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":a[0]||(a[0]=c=>t.tempOrder.is_paid=c)},null,512),[[U,t.tempOrder.is_paid]]),e("label",ve,[t.tempOrder.is_paid?(d(),n("span",ye,"\u5DF2\u4ED8\u6B3E")):(d(),n("span",Oe,"\u672A\u4ED8\u6B3E"))])])])])])]),e("div",ke,[Me,e("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=c=>o.$emit("update-paid",t.tempOrder))}," \u4FEE\u6539\u4ED8\u6B3E\u72C0\u614B ")])])])],512)}var we=j(z,[["render",xe]]);const Pe={components:{Pagination:E,OrderModal:we,DelModal:I},name:"admin-Orders",setup(){const o=u(!1),a=u({}),i=u({}),t=u({}),m=u(!1),b=u({}),c=u({}),f=u(1);S(async()=>{a.value=new L(document.getElementById("orderModal"),{keyboard:!1}),i.value=new L(document.getElementById("delModal"),{keyboard:!1});try{await O.auth.checkAuth(),h()}catch(l){console.log(l),alert(l.message)}});const h=async(l=1)=>{f.value=l,o.value=!0;try{const _=await O.adminOrder.getOrders(l);t.value=_.orders,b.value=_.pagination,o.value=!1}catch(_){alert(_.message),o.value=!1}};return{orders:t,tempOrder:c,isLoading:o,getOrders:h,pagination:b,openModal:l=>{m.value=!1,c.value=C({},l)},updatePaid:async l=>{o.value=!0;try{const _=await O.adminOrder.updateOrders(l.id,{data:{is_paid:l.is_paid}});o.value=!1,alert(_.message),a.value.hide(),h(f.value)}catch(_){alert(_.message),o.value=!1}},delOrder:async()=>{try{const l=await O.adminOrder.delOrder(c.value.id);o.value=!1,alert(l.message),i.value.hide(),h(f.value)}catch(l){alert(l.message),o.value=!1}}}}},Ce={class:"container"},De={class:"row py-1"},Ue={class:"col-12 col-sm-12"},Le={class:"table table-hover mt-4"},je=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"\u8CFC\u8CB7\u6642\u9593"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"\u8CFC\u8CB7\u6B3E\u9805"),e("th",{scope:"col"},"\u61C9\u4ED8\u91D1\u984D"),e("th",{scope:"col"},"\u662F\u5426\u4ED8\u6B3E"),e("th",{scope:"col"},"\u64CD\u4F5C")])],-1),Ve=["textContent"],$e={class:"list-unstyled"},Be={class:"text-right"},Ee={class:"form-check form-switch"},Ie=["id","onUpdate:modelValue","onChange"],Ne=["for"],Se={key:0},qe={key:1},ze={class:"btn-group"},Ae=["onClick"],Fe=["onClick"];function Ge(o,a,i,t,m,b){const c=v("Loading"),f=v("Pagination"),h=v("OrderModal"),M=v("DelModal");return d(),n("div",Ce,[p(" Loading "),y(c,{active:t.isLoading,"onUpdate:active":a[0]||(a[0]=s=>t.isLoading=s),"is-full-page":!0},null,8,["active"]),e("div",De,[e("div",Ue,[e("table",Le,[je,e("tbody",null,[(d(!0),n(g,null,k(t.orders,(s,x)=>(d(),n(g,{key:x},[t.orders.length?(d(),n("tr",{key:0,class:q({"text-primary":!s.is_paid})},[e("td",null,r(o.$filters.date(s.create_at)),1),e("td",null,[s.user?(d(),n("span",{key:0,textContent:r(s.user.email)},null,8,Ve)):p("v-if",!0)]),e("td",null,[e("ul",$e,[(d(!0),n(g,null,k(s.products,(l,_)=>(d(),n("li",{key:_},r(l.product.title)+" \u6578\u91CF\uFF1A"+r(l.qty)+" "+r(l.product.unit),1))),128))])]),e("td",Be,r(s.total),1),e("td",null,[e("div",Ee,[D(e("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${s.id}`,"onUpdate:modelValue":l=>s.is_paid=l,onChange:l=>t.updatePaid(s)},null,40,Ie),[[U,s.is_paid]]),e("label",{class:"form-check-label",for:`paidSwitch${s.id}`},[s.is_paid?(d(),n("span",Se,"\u5DF2\u4ED8\u6B3E")):(d(),n("span",qe,"\u672A\u4ED8\u6B3E"))],8,Ne)])]),e("td",null,[e("div",ze,[e("button",{class:"btn btn-outline-primary btn-sm",type:"button","data-bs-target":"#orderModal","data-bs-toggle":"modal",onClick:l=>t.openModal(s)}," \u6AA2\u8996 ",8,Ae),e("button",{class:"btn btn-outline-danger btn-sm",type:"button","data-bs-target":"#delModal","data-bs-toggle":"modal",onClick:l=>t.openModal(s)}," \u522A\u9664 ",8,Fe)])])],2)):p("v-if",!0)],64))),128))])])])]),p(' <Pagination :pages="pagination" @emit-pages="getProducts"></Pagination> '),y(f,{pages:t.pagination,"onUpdate:pages":a[1]||(a[1]=s=>t.pagination=s),onUpdatePages:t.getOrders},null,8,["pages","onUpdatePages"]),p(" Modal "),y(h,{order:t.tempOrder,"onUpdate:order":a[2]||(a[2]=s=>t.tempOrder=s),ref:"orderModal",onUpdatePaid:t.updatePaid},null,8,["order","onUpdatePaid"]),p(" delModal "),y(M,{ref:"delModal",item:t.tempOrder,"onUpdate:item":a[3]||(a[3]=s=>t.tempOrder=s),onDelItem:t.delOrder},null,8,["item","onDelItem"])])}var We=j(Pe,[["render",Ge]]);export{We as default};
