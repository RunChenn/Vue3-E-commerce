import{v as i,V as T,D as R,r as g,o as c,b as m,d as u,e as h,w as o,y as A,z as j,O as y,W as L,B as k,J as N,K as U,C as w}from"./vendor.1eeb228f.js";import{a as _}from"./index.06ff196c.js";import{C as V,F as B}from"./Form.64db5a3e.js";import{R as M}from"./RelatedProds.3dad6fab.js";import{_ as P}from"./index.fa9b4643.js";const D={components:{Carts:V,Form:B,RelatedProds:M},name:"Products",setup(){const d=i(!1),e=i({}),p=i(""),t=T({loadingItem:""}),f=i(!1),x=i(0),v=i("");R(async()=>{d.value=!0,n()});const n=async()=>{try{const a=await _.cart.getCart();e.value=a.data,d.value=!1}catch(a){alert(a.message),d.value=!1}};return{isLoading:d,cart:e,loadingStatus:t,getCart:n,addToCart:async(a,r=1)=>{productModal.value.hide();try{t.loadingItem=a;const b={product_id:a,qty:r},S=await _.cart.addCart({data:b});alert(S.message),t.loadingItem="",n()}catch(b){alert(b.message)}},removeCartItem:async a=>{try{const r=await _.cart.removeCartItem(a);t.loadingItem=a,alert(r.message),t.loadingItem="",n()}catch(r){alert(r.message)}},removeCartAll:async()=>{try{const a=await _.cart.removeCartAll();alert(a.message),n()}catch(a){alert(a.message)}},updateCart:async a=>{try{t.loadingItem=a.id;const r={product_id:a.product_id,qty:a.qty},b=await _.cart.updateCart({data:r});alert(b.message),t.loadingItem="",n()}catch(r){t.loadingItem="",alert(r.message)}},codeText:p,addConpon:async()=>{try{t.loadingItem=p.value!=="";const a={code:p.value},r=await _.coupon.addConpon({data:a});f.value=!0,p.value="",v.value=r.message.split(":")[1],alert(r.message),t.loadingItem="",n()}catch(a){t.loadingItem="",alert(a.message)}},isHaveCoupon:f,couponTotal:x,codeMsg:v}}},l=d=>(N("data-v-77ef69c4"),d=d(),U(),d),F={class:"container pt-4"},H={class:"mt-3"},q=l(()=>o("h3",{class:"mt-3 mb-4"},[o("i",{class:"fas fa-shopping-cart"}),w("\xA0\u8CFC\u7269\u8ECA")],-1)),z={key:0,class:"row"},E={class:"col-md-8"},J={class:"row justify-content-between"},K={class:"col-auto"},O=["disabled"],W={class:"col-auto"},G={class:"input-group w-100 mb-3"},Q={class:"input-group-append"},X=["disabled"],Y={key:0,class:"fas fa-spinner fa-pulse"},Z={key:1,class:"fas fa-paper-plane"},$={class:"col-md-4"},tt={class:"border p-4 mb-4"},ot=l(()=>o("h4",{class:"fw-bold mb-4"},"\u8A02\u55AE\u8CC7\u8A0A",-1)),at={class:"table text-muted border-bottom"},et=l(()=>o("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"\u5C0F\u8A08",-1)),st={class:"text-end border-0 px-0 pt-4"},rt={key:0},dt=l(()=>o("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"\u512A\u60E0\u5238",-1)),nt={class:"text-end border-0 px-0 pt-0 pb-4"},ct={class:"d-flex justify-content-between mt-4"},lt=l(()=>o("p",{class:"mb-0 h4 fw-bold"},"\u7E3D\u91D1\u984D",-1)),it={class:"mb-0 h4 fw-bold"},mt=w("\u524D\u5F80\u7D50\u5E33"),_t={key:1,class:"row"},pt={class:"border p-4 mb-4"},bt=l(()=>o("h4",{class:"fw-bold mt-3 mb-4"},"\u8CFC\u7269\u8ECA\u76EE\u524D\u6C92\u6709\u5546\u54C1",-1)),vt=w("\u7E7C\u7E8C\u8CFC\u7269"),gt={class:"my-5"},ut=l(()=>o("h3",{class:"fw-bold"},"\u76F8\u95DC\u7522\u54C1",-1));function ht(d,e,p,t,f,x){const v=g("Loading"),n=g("Carts"),C=g("router-link"),I=g("RelatedProds");return c(),m("div",F,[u(" Loading "),h(v,{active:t.isLoading,"onUpdate:active":e[0]||(e[0]=s=>t.isLoading=s),"is-full-page":!0},null,8,["active"]),o("div",H,[q,t.cart.carts&&t.cart.carts.length!==0?(c(),m("div",z,[o("div",E,[h(n,{cart:t.cart,"onUpdate:cart":e[1]||(e[1]=s=>t.cart=s),loadingStatus:t.loadingStatus,"onUpdate:loadingStatus":e[2]||(e[2]=s=>t.loadingStatus=s),onRemoveCartItem:t.removeCartItem,onRemoveCartAll:t.removeCartAll,onUpdateCart:t.updateCart},null,8,["cart","loadingStatus","onRemoveCartItem","onRemoveCartAll","onUpdateCart"]),o("div",J,[o("div",K,[o("button",{class:"btn btn-outline-primary",type:"button",onClick:e[3]||(e[3]=(...s)=>t.removeCartAll&&t.removeCartAll(...s)),disabled:t.cart.carts&&t.cart.carts.length===0},"\u6E05\u7A7A\u8CFC\u7269\u8ECA",8,O)]),o("div",W,[o("div",G,[A(o("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"\u8F38\u5165\u512A\u60E0\u5238","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":e[4]||(e[4]=s=>t.codeText=s)},null,512),[[j,t.codeText]]),o("div",Q,[o("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",disabled:t.loadingStatus.loadingItem===(t.codeText!=="")||t.codeText==="",onClick:e[5]||(e[5]=(...s)=>t.addConpon&&t.addConpon(...s))},[t.loadingStatus.loadingItem===t.isHaveCoupon?(c(),m("i",Y)):(c(),m("i",Z))],8,X)])])])])]),o("div",$,[o("div",tt,[ot,o("table",at,[o("tbody",null,[o("tr",null,[et,o("td",st,"NT$"+y(t.cart.total),1)]),t.isHaveCoupon?(c(),m("tr",rt,[dt,o("td",nt,y(t.codeMsg),1)])):u("v-if",!0)])]),o("div",ct,[lt,o("p",it,"NT$"+y(t.cart.final_total),1)]),u(' <a href="./checkout.html" class="btn btn-dark w-100 mt-4">\u524D\u5F80\u7D50\u5E33</a> '),t.cart.carts&&t.cart.carts.length!==0?(c(),L(C,{key:0,class:"btn btn-dark w-100 mt-4",to:"/checkout"},{default:k(()=>[mt]),_:1})):u("v-if",!0)])])])):(c(),m("div",_t,[o("div",pt,[bt,h(C,{class:"btn btn-primary",to:"/products"},{default:k(()=>[vt]),_:1})])])),o("div",gt,[ut,h(I)])])])}var St=P(D,[["render",ht],["__scopeId","data-v-77ef69c4"]]);export{St as default};
