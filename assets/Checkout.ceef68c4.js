import{C as w,D as C,r as p,X as k,o as j,g,b as d,d as i,O as u,h as x,f as t,F as I,e as O,t as c,R as F,T as L}from"./vendor.72820acd.js";import{a as y}from"./index.40a71972.js";import{_ as S,e as M}from"./index.fa8506b3.js";import{C as N,F as R}from"./Form.8007c743.js";import{R as B}from"./RelatedProds.1977b4f4.js";const T={components:{Carts:N,Form:R,RelatedProds:B},name:"Checkout",setup(){var b;const a=(b=w())==null?void 0:b.appContext.config.globalProperties.$httpMsgState,r=C(),s=p(!1),e=p({}),f=k({loadingItem:""}),h=p(!1),l=p("");j(async()=>{s.value=!0,_(),M.emit("get-cart")});const _=async()=>{try{const n=await y.cart.getCart();e.value=n.data,e.value.carts[0].coupon&&(h.value=!0,l.value=e.value.carts[0].coupon.code),s.value=!1}catch(n){s.value=!1,a(n,"\u932F\u8AA4\u8A0A\u606F")}};return{isLoading:s,cart:e,loadingStatus:f,getCart:_,createOrder:async n=>{s.value=!0;try{const v=await y.order.addOrder({data:n});r.push({name:"checkout-success",params:{id:v.orderId}}),s.value=!1}catch(v){f.loadingItem="",s.value=!1,a(v,"\u932F\u8AA4\u8A0A\u606F")}},isHaveCoupon:h,codeMsg:l}}},m=a=>(F("data-v-47c45a2c"),a=a(),L(),a),D={class:"container pt-4"},H={class:"mt-3"},P={class:"row flex-row-reverse justify-content-center pb-5"},V={key:0,class:"col-md-6"},q={class:"border p-4 mb-4"},E=m(()=>t("img",{src:"https://images.unsplash.com/photo-1502743780242-f10d2ce370f3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1916&q=80",alt:"checkout-img",class:"me-2 checkout-product-img"},null,-1)),U={class:"w-100"},J={class:"d-flex justify-content-between"},Q={class:"mb-0 fw-bold"},W={class:"mb-0"},X={class:"mb-0 fw-bold"},z={class:"table mt-4 border-top border-bottom text-muted"},A=m(()=>t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"\u5C0F\u8A08",-1)),G={class:"text-end border-0 px-0 pt-4"},K={key:0},Y=m(()=>t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"\u512A\u60E0\u5238",-1)),Z={class:"text-end border-0 px-0 pt-0 pb-4"},$={class:"d-flex justify-content-between mt-4"},tt=m(()=>t("p",{class:"mb-0 h4 fw-bold"},"\u7E3D\u91D1\u984D",-1)),et={class:"mb-0 h4 fw-bold"},ot={class:"col-md-6"};function st(a,r,s,e,f,h){const l=g("Loading"),_=g("Form");return d(),i("div",D,[u(" Loading "),x(l,{active:e.isLoading,"onUpdate:active":r[0]||(r[0]=o=>e.isLoading=o),"is-full-page":!0},null,8,["active"]),t("div",H,[t("div",P,[e.cart.carts?(d(),i("div",V,[t("div",q,[(d(!0),i(I,null,O(e.cart.carts,o=>(d(),i("div",{class:"d-flex",key:o.id},[E,t("div",U,[t("div",J,[t("p",Q,c(o.product.title),1),t("p",W,"NT$"+c(o.product.price),1)]),t("p",X,"x"+c(o.qty),1)])]))),128)),t("table",z,[t("tbody",null,[t("tr",null,[A,t("td",G,"NT$"+c(e.cart.total),1)]),e.isHaveCoupon?(d(),i("tr",K,[Y,t("td",Z,c(e.codeMsg),1)])):u("v-if",!0)])]),t("div",$,[tt,t("p",et,"NT$"+c(e.cart.final_total),1)])])])):u("v-if",!0),t("div",ot,[u(" \u8868\u55AE "),x(_,{onCreateOrder:e.createOrder,cart:e.cart,"onUpdate:cart":r[1]||(r[1]=o=>e.cart=o)},null,8,["onCreateOrder","cart"])])])])])}var it=S(T,[["render",st],["__scopeId","data-v-47c45a2c"]]);export{it as default};
